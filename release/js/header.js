"use strict";var $DT2017=$DT2017||{};$DT2017.header=function(){var e={init:function(e){console.log("--> init header : ",e),e.targetElement.innerHTML="";var t=this,o=$alt.ce({tag:"div","class":"topMenubarContainer",targetElement:e.targetElement}),a=$alt.ce({tag:"div","class":"topMenubarTop",targetElement:o}),r=$alt.ce({tag:"div","class":"topMenubarTopTitle",html:"내 서재",targetElement:a}),n=$alt.ce({tag:"div","class":"headerSlideButton",targetElement:a});n.addEventListener("click",function(e){e.preventDefault(),console.log("--> click headerSlide button!"),$DT2017.slide.open({targetElement:document.body})},!1);var i=$alt.ce({tag:"div","class":"headerStoreButton",targetElement:a});i.addEventListener("click",function(e){e.preventDefault(),"store"===$DT2017.core.currentPageMode?window.location.replace("index.html"):$DT2017.apiBridge.goStore()},!1);var c=$alt.ce({tag:"div","class":"headerMoreButton",targetElement:a});c.setAttribute("data-over",!1),c.addEventListener("click",function(e){e.preventDefault(),console.log("--> click headerMore button!"),t.showHeaderMoreMenu({moreButton:this})},!1);var s=$alt.ce({tag:"div","class":"topMenubarBottom",targetElement:o});this.initMoreSubMenu(a),"store"===$DT2017.core.currentPageMode&&(r.innerHTML="교과서 내려받기",r.style.backgroundImage="url(./images/header/header_importFile.png)",r.style.backgroundPosition="-5px 2px",r.style.backgroundSize="50px",r.style.marginLeft="-112px",s.style.display="none",i.style.backgroundImage="url(./images/header/header_bookShelf.png)"),e.callBack&&e.callBack()},initMoreSubMenu:function(e){console.log("--> initMoreSubMenu ...");var t=this,o=$alt.ce({tag:"div","class":"moreMenuBackground",targetElement:e});o.addEventListener("click",function(e){e.preventDefault(),t.showHeaderMoreMenu({moreButton:$alt.qs(".headerMoreButton")})},!1);var a=($alt.ce({tag:"div","class":"moreMenuButtonOver",targetElement:o}),$alt.ce({tag:"div","class":"moreMenuContainer",targetElement:o})),r=$alt.ce({tag:"div","class":"moreMenuImportFile",html:"불러오기",targetElement:a});r.addEventListener("click",function(e){switch(e.preventDefault(),$alt.detect.getPlatform()){case"WIN":case"RT":console.log("%c ▶▷ [Native API] importContent ","color:#ff6600");var t={apiName:"importContent",parameters:{},callBack:"importContentCallBack"};window[t.callBack]=function(e){e=decodeURIComponent(e),e=JSON.parse(e);var o=Object.keys(e);switch(o[0]){case"response":$DT2017.core.bookCaseList=[];var a="";e.response.UserData.BookShelf.shelfItem.forEach(function(e,t){$DT2017.core.bookCaseList.push(e),"yes"===e.isDefaultShelf.toLowerCase().trim()&&(a=e)}),$DT2017.core.contentsList=[],$DT2017.core.mergeContents({DtextData:e.response.DtextBook.BookList.bookItem,UserData:e.response.UserData.BookList.bookItem,callBack:function(){$DT2017.bookCase.selectBookCaseName(a),$DT2017.bookCase.currentBookCaseIndex=0,$DT2017.view.reload()}});break;case"error":$DT2017.notice.show({noticeText:e.error?e.error:"파일을 불러오지 못했습니다!",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.notice.hide()}})}delete window[t.callBack]},$DT2017.apiBridge.sendMessageToNative(t.apiName,JSON.stringify(t));break;default:$DT2017.layerPop.show({title:'<img class="importFileIcon" src="./images/subMenu/importFileIcon.png">불러올 책 선택',noticeText:"",buttonText:"확 인",yesButtonEvent:function(){if(console.log("> clickEvent!"),console.log("#------------------------------------------#"),console.log($DT2017.core.selectedImportList),console.log("#------------------------------------------#"),0===$DT2017.core.selectedImportList.length)return void $DT2017.notice.show({noticeText:"불러올 책을 선택하세요!",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.notice.hide()}});this.style.pointerEvents="none",console.log("%c ▶▷ [Native API] importContent ","color:#ff6600");var e={apiName:"importContent",parameters:{importBookList:$DT2017.core.selectedImportList},callBack:"importContentCallBack"};window[e.callBack]=function(t){var o=Object.keys(t);switch(o[0]){case"response":$DT2017.view.refresh({response:t}),$DT2017.bookCase.selectBookCaseName($DT2017.core.bookCaseList[0]);break;case"error":$DT2017.notice.show({noticeText:t.error?t.error:"파일을 불러오지 못했습니다!",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.notice.hide()}})}delete window[e.callBack]},$DT2017.apiBridge.sendMessageToNative(e.apiName,JSON.stringify(e));var t={response:{UserData:{BookShelf:{shelfItem:[{name:"기본 책장",bookRef:[{bookId:"furn:uuid:05c44144-01ae-62fe-9d15-cd52cf052c87"},{bookId:"urn:uuid:39504f4e-6c55-6149-a61a-5f1ccd34a8c5"}],isDefaultShelf:"yes"},{name:"추가 책장",bookRef:[],isDefaultShelf:"no"}]},BookList:{bookItem:[{metadata:{coverImage:"",title:"가sub01",description:"",publisher:"",date:"2017-08-24T00:00:00Z"},bookId:"urn:uuid:39504f4e-6c55-6149-a61a-5f1ccd34a8c5",type:"EPUB",extractPath:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/UserData/test/Contents/39504f4e-6c55-6149-a61a-5f1ccd34a8c5"}]}},DtextBook:{BookList:{bookItem:[{downloadUrl:"",epubItem:[{packagingDate:"",subBookId:"urn:uuid:39504f4e-6c55-6149-a61a-5f1ccd34a8c5",downloadUrl:"",title:"sub01",coverImage:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/DtextBook/05c44144-01ae-62fe-9d15-cd52cf052c87",isDownload:"yes",isUpdate:"no",epubItemId:"book_001",startPageNumber:"-4",extractPath:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/DtextBook/05c44144-01ae-62fe-9d15-cd52cf052c87/sub01.epub",lesson:" 한글파일명 서브01 "},{packagingDate:"",subBookId:"urn:uuid:ecf98835-6fb8-689a-a328-46f409be1b83",downloadUrl:"",title:"sub02",coverImage:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/DtextBook/05c44144-01ae-62fe-9d15-cd52cf052c87",isDownload:"yes",isUpdate:"no",epubItemId:"book_002",startPageNumber:"9",extractPath:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/DtextBook/05c44144-01ae-62fe-9d15-cd52cf052c87/sub02.epub",lesson:" 한글파일명 서브02 "},{packagingDate:"",subBookId:"urn:uuid:d7b8eccc-5bee-61d3-87c5-1d4b605cfb2c",downloadUrl:"",title:"sub03",coverImage:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/DtextBook/05c44144-01ae-62fe-9d15-cd52cf052c87",isDownload:"yes",isUpdate:"no",epubItemId:"book_003",startPageNumber:"12",extractPath:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/DtextBook/05c44144-01ae-62fe-9d15-cd52cf052c87/sub03.epub",lesson:" 한글파일명 서브03 "}],isUpdate:"no",contentsSeq:"",isDownload:"yes",fullBookId:"furn:uuid:05c44144-01ae-62fe-9d15-cd52cf052c87",type:"DTPCONTENTS",metadata:{title:"나_교과서명",date:"2017-08-24T00:00:00Z",rightsHolder:"저작권자1, 저작권자2",creator:"편찬자(저자)1, 편찬자(저자)2",producer:"발행인",subject:"주제 주제 주제 주제 주제 주제 주제",publisher:"발행사(영어)publisher",description:"디스크립션",gradeGroup:"초등학교",schoolGrade:"통합",courseName:"통합",packagingDate:"2017-08-24T05:25:05Z",coverImage:""},extractPath:"/Users/tovsoft/Library/Developer/CoreSimulator/Devices/645E97EC-D8DC-4CED-AA64-B2B595D835DD/data/Containers/Data/Application/B8CCC061-9DF5-4B68-8C5C-1B5568D5DE74/Library/CyberEdu/DtextBook/05c44144-01ae-62fe-9d15-cd52cf052c87"}]}}}};window[e.callBack](t),$DT2017.layerPop.hide()},noButtonText:"취소",noButtonEvent:function(){$DT2017.layerPop.hide()},callBack:$DT2017.importFile.append})}},!1);var n=$alt.ce({tag:"div","class":"headerSearch",html:"책 검색",targetElement:a});n.addEventListener("click",function(e){e.preventDefault(),$DT2017.search.appendSearchContainer({targetElement:document.body})},!1);var i=$alt.ce({tag:"div","class":"headerDelBook",html:"책 이동/삭제",targetElement:a});i.addEventListener("click",function(e){e.preventDefault(),$DT2017.bookEdit.onBookEditMode({mode:"moveDelete"})},!1);var c=$alt.ce({tag:"div","class":"headerEditShelf",html:"책장 관리",targetElement:a});c.addEventListener("click",function(e){e.preventDefault(),$DT2017.layerPop.show({title:'<img class="importFileIcon" src="./images/subMenu/editBookShelfIcon.png">책장 관리',noticeText:"",buttonText:"확 인",yesButtonEvent:function(){console.log("> clickEvent!"),$DT2017.layerPop.hide()},noButtonText:"취소",noButtonEvent:function(){$DT2017.layerPop.hide()},callBack:$DT2017.sub.initEditBookShelf})},!1);var s=$alt.ce({tag:"div","class":"headerMode",html:"image"===$DT2017.core.currentListType?"리스트형 보기":"썸네일형 보기",targetElement:a});s.addEventListener("click",function(e){e.preventDefault(),"image"===$DT2017.core.currentListType?($DT2017.core.currentListType="list",this.innerHTML="썸네일형 보기"):($DT2017.core.currentListType="image",this.innerHTML="리스트형 보기"),$DT2017.view.reload()},!1);var l=$alt.ce({tag:"div","class":"headerSort",html:$DT2017.core.currentSortType?"최근순 정렬":"제목순 정렬",targetElement:a});l.addEventListener("click",function(e){e.preventDefault(),$DT2017.core.currentSortType?($DT2017.core.currentSortType=!1,this.innerHTML="제목순 정렬"):($DT2017.core.currentSortType=!0,this.innerHTML="최근순 정렬"),"store"===$DT2017.core.currentPageMode?$DT2017.bookCase.getCurrentBookListBySort({bookGroup:$DT2017.core.contentsList}):$DT2017.bookCase.getCurrentBookListBySort({bookGroup:$DT2017.core.selectedBookCase.bookGroup}),$DT2017.view.reload()},!1);var d=$alt.ce({tag:"div","class":"sendWedorang",html:"위두랑 전송",targetElement:a});if(d.addEventListener("click",function(e){e.preventDefault(),$DT2017.bookEdit.onBookEditMode({mode:"wedorang"})},!1),"ANDROID"===$alt.detect.getPlatform()){var D=$alt.ce({tag:"div","class":"moveStorage",html:"저장위치 변경",targetElement:a});D.addEventListener("click",function(e){e.preventDefault(),$DT2017.bookEdit.onBookEditMode({mode:"moveStorage"})},!1)}"store"===$DT2017.core.currentPageMode&&(this.disableElement(r),this.disableElement(i),this.disableElement(c),"ANDROID"===$alt.detect.getPlatform()&&this.disableElement(D),d.style.display="none")},showHeaderMoreMenu:function(e){var t=$alt.qs(".moreMenuBackground"),o=e.moreButton,a=o.getAttribute("data-over");"true"===a?(o.setAttribute("data-over",!1),t.style.display="none"):(o.setAttribute("data-over",!0),t.style.display="block")},disableElement:function(e){e.style.pointerEvents="none",e.style.opacity=.3},setOfflineMode:function(){var e=$alt.qs(".headerStoreButton"),t=$alt.qs("#slideStoreBtn"),o=$alt.qs("#slideNoticeBtn"),a=$alt.qs(".sendWedorang"),r=$alt.qs(".userProfileImg"),n=$alt.qs("#wedorangCommunity"),i=$alt.qs("#slideFaq"),c=$alt.qs("#slideCode");[e,t,o,a,r,i,c,n].forEach(function(e){e&&(e.style.opacity=.3,e.style.pointerEvents="none")})}};return e}();