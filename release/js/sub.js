"use strict";var $DT2017=$DT2017||{};$DT2017.sub=function(){var e={initEditBookShelf:function(e){console.log("--> initEditBookShelf...");var t=$alt.ce({tag:"div","class":"bookShelfBox",targetElement:e});$DT2017.responsive.screenSize.width<=$DT2017.responsive.responsivePointHiDPI.smallMobile?t.style.height="185px":t.style.height="280px",$DT2017.sub.initBookCaseList(t)},initBookCaseList:function(e){e.innerHTML="";var t=$alt.ce({tag:"div","class":"bookShelfAddButton",html:"새 책장",targetElement:e});t.addEventListener("click",function(e){e.preventDefault(),$DT2017.sub.addBookCaseNotice()},!1);var o;o=$DT2017.responsive.screenSize.width<=$DT2017.responsive.responsivePointHiDPI.smallMobile?"73%":"87%",$DT2017.core.bookCaseList.forEach(function(t,n){var i=$alt.ce({tag:"div","class":"bookCaseListElement",targetElement:e}),s=$alt.ce({tag:"div","class":"bookCaseListText",html:t.name,targetElement:i});s.style.width=o;var a=$alt.ce({tag:"img","class":"bookCaseListEditButton",src:"./images/subMenu/editBookShelf_edit.png",targetElement:i});a.setAttribute("bookCaseIdx",n),a.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("bookCaseIdx");$DT2017.sub.editBookCaseNotice(t)},!1);var l=$alt.ce({tag:"img","class":"bookCaseListDelButton",src:"./images/subMenu/editBookShelf_del.png",targetElement:i});l.setAttribute("bookCaseIdx",n),l.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("bookCaseIdx");$DT2017.sub.delBookCaseNotice(t)},!1),"yes"===t.isDefaultShelf.toLowerCase().trim()&&(l.style.opacity=.3,l.style.pointerEvents="none",a.style.opacity=.3,a.style.pointerEvents="none")})},addBookCaseNotice:function(){var e=!1;$DT2017.notice.show({type:"confirm",title:"새 책장",noticeText:"",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!");var e=$alt.qs("#bookCaseNameInput").value;return e?($DT2017.sub.addBookCaseList(e),$DT2017.sub.initBookCaseList($alt.qs(".bookShelfBox")),$DT2017.bookEdit.updateBookCase(),$DT2017.notice.hide(),void $DT2017.bookCase.selectBookCaseName($DT2017.core.bookCaseList[$DT2017.bookCase.currentBookCaseIndex])):void $DT2017.notice.show({noticeText:"새 책장 이름을 입력해주세요!",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.sub.addBookCaseNotice()}})},noButtonText:"취소",noButtonEvent:function(){$DT2017.notice.hide()},callBack:function(t){var o=$alt.ce({tag:"input",id:"bookCaseNameInput",targetElement:t});o.setAttribute("placeholder","책장 이름을 입력하세요."),o.setAttribute("maxlength",30),o.addEventListener("keyup",function(o){if(console.log("- value.length: ",this.value.length),this.value.length>=30)return $DT2017.sub.maxlengthNotice(t),void(this.value=this.value.substring(0,29));if(13===o.keyCode&&!e){var n=$alt.qs("#bookCaseNameInput").value;if(!n)return void $DT2017.notice.show({noticeText:"새 책장 이름을 입력해주세요!",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.sub.addBookCaseNotice()}});$DT2017.sub.addBookCaseList(n),$DT2017.sub.initBookCaseList($alt.qs(".bookShelfBox")),$DT2017.bookEdit.updateBookCase(),console.log("$$$$$$$$$$$$$$$$$$$$$$$$ event!"),$DT2017.notice.hide(),$DT2017.bookCase.selectBookCaseName($DT2017.core.bookCaseList[$DT2017.bookCase.currentBookCaseIndex]),e=!0}},!1),o.focus()}})},editBookCaseNotice:function(e){var t=!1;$DT2017.notice.show({type:"confirm",title:"책장 수정",noticeText:"",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!");var t=$alt.qs("#bookCaseNameInput").value;return t?($DT2017.core.bookCaseList[e].name=t,$DT2017.bookCase.currentBookCaseIndex==e&&($alt.qs(".topMenubarBottomShelfListText").innerHTML=t+" ("+$DT2017.core.bookCaseList[e].bookRef.length+"권)"),$DT2017.sub.initBookCaseList($alt.qs(".bookShelfBox")),$DT2017.bookEdit.updateBookCase(),$DT2017.notice.hide(),void $DT2017.bookCase.selectBookCaseName($DT2017.core.bookCaseList[$DT2017.bookCase.currentBookCaseIndex])):void $DT2017.notice.show({noticeText:"수정할 책장 이름을 입력해주세요!",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.sub.editBookCaseNotice(e)}})},noButtonText:"취소",noButtonEvent:function(){$DT2017.notice.hide()},callBack:function(o){var n=$alt.ce({tag:"input",id:"bookCaseNameInput",targetElement:o});n.value=$DT2017.core.bookCaseList[e].name,n.setAttribute("maxlength",30),n.addEventListener("keyup",function(i){console.log("- value.length: ",this.value.length),this.value.length>=30&&($DT2017.sub.maxlengthNotice(o),this.value=this.value.substring(0,30)),13!==i.keyCode||t||($DT2017.core.bookCaseList[e].name=n.value,$DT2017.bookCase.currentBookCaseIndex==e&&($alt.qs(".topMenubarBottomShelfListText").innerHTML=bookCaseName+" ("+$DT2017.core.bookCaseList[e].bookRef.length+"권)"),$DT2017.sub.initBookCaseList($alt.qs(".bookShelfBox")),$DT2017.bookEdit.updateBookCase(),$DT2017.notice.hide(),$DT2017.bookCase.selectBookCaseName($DT2017.core.bookCaseList[$DT2017.bookCase.currentBookCaseIndex]),t=!0)},!1),n.focus()}})},delBookCaseNotice:function(e){$DT2017.notice.show({type:"confirm",title:"책장 삭제",noticeText:"<p>선택한 책장을 삭제합니다. </p> <p>이 책장에 있는 책들은 <br> 기본  책장으로 이동합니다.</p>",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.sub.moveBookCaseItem($DT2017.core.bookCaseList[e].bookRef),$DT2017.core.bookCaseList.splice(e,1),$DT2017.sub.initBookCaseList($alt.qs(".bookShelfBox")),$DT2017.bookEdit.updateBookCase(),$DT2017.view.reload(),$DT2017.notice.hide(),$DT2017.bookCase.currentBookCaseIndex=0,$DT2017.bookCase.selectBookCaseName($DT2017.core.bookCaseList[0])},noButtonText:"취소",noButtonEvent:function(){$DT2017.notice.hide()}})},moveBookCaseItem:function(e){console.log("--> moveBookCaseItem: ",e),$DT2017.core.bookCaseList.forEach(function(t,o){if("yes"===t.isDefaultShelf.toLowerCase().trim()){for(var n=0;n<e.length;n++)t.bookRef.push(e[n]);$DT2017.bookCase.selectBookCaseName(t),$DT2017.bookCase.currentBookCase=t.name}}),console.log($DT2017.core.bookCaseList)},addBookCaseList:function(e){$DT2017.core.bookCaseList.push({isDefaultShelf:"no",name:e,bookRef:[]})},maxlengthNotice:function(e){var t=$alt.qs(".maxlengthNotice");t||(t=$alt.ce({tag:"div","class":"maxlengthNotice",html:"책장 이름은 30자로 제한되어 있습니다.",targetElement:e}))},appendCommunity:function(){$DT2017.notice.show({title:'<img class="communityIcon" src="./images/subMenu/communityIcon.png"><div class="communityTitle">학습 커뮤니티</div>',buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.notice.hide()},callBack:$DT2017.sub.initCommunityPop})},initCommunityPop:function(e){console.log("-targetElement: ",e);var t=$alt.ce({tag:"div","class":"communityButton",html:"위두랑 바로가기",targetElement:e});t.style.backgroundColor="#101047",t.style.marginRight="10px",t.addEventListener("click",function(e){e.preventDefault(),console.log("- communityWebBtn!"),$DT2017.apiBridge.openCommunity(),$DT2017.notice.hide()},!1);var o=$alt.ce({tag:"div","class":"communityButton",html:"위두랑 앱 열기",targetElement:e});o.style.backgroundColor="#f26422",o.addEventListener("click",function(e){switch(e.preventDefault(),console.log("- communityAppBtn!"),$alt.detect.getPlatform()){case"WIN":case"RT":$DT2017.notice.show({noticeText:"모바일 전용 기능입니다.",buttonText:"확 인",clickEvent:function(){console.log("> clickEvent!"),$DT2017.notice.hide()}});break;default:$DT2017.apiBridge.openApp(),$DT2017.notice.hide()}},!1),$alt.qs("#noticeBodyText").style.marginTop="10px",$DT2017.responsive.screenSize.width<=$DT2017.responsive.responsivePointHiDPI.smallMobile?(e.style.width="310px",e.style.height="170px"):(e.style.width="600px",e.style.height="230px",t.style.width="230px",o.style.width="230px",t.style.height="60px",o.style.height="60px",t.style.lineHeight="60px",o.style.lineHeight="60px",t.style.fontSize="20px",o.style.fontSize="20px",t.style.marginTop="20px",o.style.marginTop="20px")}};return e}();